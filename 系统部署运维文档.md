# ç³»ç»Ÿéƒ¨ç½²è¿ç»´æ–‡æ¡£

> ä¾¿åˆ©åº—è¿›é”€å­˜ç³»ç»Ÿéƒ¨ç½²å’Œè¿ç»´æŒ‡å—  
> åŸºäºå®é™…é¡¹ç›®ç»“æ„  
> æ›´æ–°æ—¶é—´: 2025å¹´1æœˆ8æ—¥  
> ç‰ˆæœ¬: v1.0.0

## ğŸ¯ ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

### æŠ€æœ¯æ ˆ
- **å‰ç«¯**: Vue 3 + Vite + Element Plus
- **åç«¯**: Node.js + Express.js
- **æ•°æ®åº“**: Supabase PostgreSQL
- **æµ‹è¯•ç¯å¢ƒ**: Honoæ¡†æ¶æœ¬åœ°æœåŠ¡å™¨
- **éƒ¨ç½²**: æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼

### é¡¹ç›®ç»“æ„
```
ke/
â”œâ”€â”€ frontend/           # å‰ç«¯Vueåº”ç”¨
â”œâ”€â”€ backend/           # åç«¯ExpressæœåŠ¡
â”œâ”€â”€ edge-functions/    # è¾¹ç¼˜å‡½æ•°å’Œæµ‹è¯•æœåŠ¡
â”œâ”€â”€ docs/             # æ–‡æ¡£ç›®å½•
â””â”€â”€ scripts/          # éƒ¨ç½²è„šæœ¬
```

## ğŸš€ ç¯å¢ƒå‡†å¤‡

### ç³»ç»Ÿè¦æ±‚
- **Node.js**: >= 16.0.0
- **npm**: >= 8.0.0
- **æ“ä½œç³»ç»Ÿ**: macOS/Linux/Windows
- **å†…å­˜**: >= 4GB
- **ç£ç›˜ç©ºé—´**: >= 2GB

### ä¾èµ–å®‰è£…

**1. å®‰è£…Node.jså’Œnpm**
```bash
# macOS (ä½¿ç”¨Homebrew)
brew install node

# éªŒè¯å®‰è£…
node --version
npm --version
```

**2. å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd ke
```

**3. å®‰è£…é¡¹ç›®ä¾èµ–**
```bash
# å‰ç«¯ä¾èµ–
cd frontend
npm install

# åç«¯ä¾èµ–
cd ../backend
npm install

# è¾¹ç¼˜å‡½æ•°ä¾èµ–
cd ../edge-functions
npm install
```

## ğŸ”§ ç¯å¢ƒé…ç½®

### ç¯å¢ƒå˜é‡é…ç½®

**1. åç«¯ç¯å¢ƒå˜é‡ (.env)**
```bash
# backend/.env
SUPABASE_URL=https://nxogjfzasogjzbkpfwle.supabase.co
SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
PORT=3000
NODE_ENV=production
```

**2. å‰ç«¯ç¯å¢ƒå˜é‡ (.env)**
```bash
# frontend/.env
VITE_API_BASE_URL=http://localhost:3001
VITE_SUPABASE_URL=https://nxogjfzasogjzbkpfwle.supabase.co
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

**3. æµ‹è¯•ç¯å¢ƒå˜é‡**
```bash
# edge-functions/.env
PORT=3001
NODE_ENV=development
```

### Supabaseé…ç½®

**1. æ•°æ®åº“è¿æ¥**
- ç¡®ä¿Supabaseé¡¹ç›®å·²åˆ›å»º
- è·å–é¡¹ç›®URLå’ŒAPIå¯†é’¥
- é…ç½®æ•°æ®åº“è¡¨ç»“æ„ï¼ˆå‚è€ƒæ•°æ®åº“è®¾è®¡æ–‡æ¡£ï¼‰

**2. å®‰å…¨è®¾ç½®**
```sql
-- å¯ç”¨è¡Œçº§å®‰å…¨ï¼ˆRLSï¼‰
ALTER TABLE suppliers ENABLE ROW LEVEL SECURITY;
ALTER TABLE products ENABLE ROW LEVEL SECURITY;
ALTER TABLE inbound_records ENABLE ROW LEVEL SECURITY;
ALTER TABLE outbound_records ENABLE ROW LEVEL SECURITY;

-- åˆ›å»ºåŸºæœ¬è®¿é—®ç­–ç•¥
CREATE POLICY "Enable read access for all users" ON suppliers FOR SELECT USING (true);
CREATE POLICY "Enable insert access for all users" ON suppliers FOR INSERT WITH CHECK (true);
CREATE POLICY "Enable update access for all users" ON suppliers FOR UPDATE USING (true);
CREATE POLICY "Enable delete access for all users" ON suppliers FOR DELETE USING (true);
```

## ğŸ—ï¸ å¼€å‘ç¯å¢ƒéƒ¨ç½²

### æœ¬åœ°å¼€å‘å¯åŠ¨

**1. å¯åŠ¨æµ‹è¯•åç«¯æœåŠ¡**
```bash
cd edge-functions
node test-local.js
```
- æœåŠ¡åœ°å€: `http://localhost:3001`
- æä¾›æ¨¡æ‹Ÿæ•°æ®å’ŒAPIæ¥å£
- æ”¯æŒçƒ­é‡è½½å’Œè°ƒè¯•

**2. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡**
```bash
cd frontend
npm run dev
```
- æœåŠ¡åœ°å€: `http://localhost:5174`
- æ”¯æŒçƒ­é‡è½½
- è‡ªåŠ¨ä»£ç†APIè¯·æ±‚

**3. å¯åŠ¨ç”Ÿäº§åç«¯æœåŠ¡ï¼ˆå¯é€‰ï¼‰**
```bash
cd backend
npm start
```
- æœåŠ¡åœ°å€: `http://localhost:3000`
- è¿æ¥çœŸå®Supabaseæ•°æ®åº“

### å¼€å‘å·¥å…·é…ç½®

**1. VS Codeé…ç½®**
```json
// .vscode/settings.json
{
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "files.associations": {
    "*.vue": "vue"
  }
}
```

**2. ESLinté…ç½®**
```javascript
// .eslintrc.js
module.exports = {
  env: {
    browser: true,
    es2021: true,
    node: true
  },
  extends: [
    'eslint:recommended',
    '@vue/eslint-config-prettier'
  ],
  rules: {
    'no-console': 'warn',
    'no-debugger': 'warn'
  }
}
```

## ğŸŒ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### å‰ç«¯éƒ¨ç½²

**1. æ„å»ºå‰ç«¯åº”ç”¨**
```bash
cd frontend
npm run build
```

**2. éƒ¨ç½²åˆ°é™æ€æ‰˜ç®¡**
```bash
# éƒ¨ç½²åˆ°Vercel
npm install -g vercel
vercel --prod

# éƒ¨ç½²åˆ°Netlify
npm install -g netlify-cli
netlify deploy --prod --dir=dist
```

**3. Nginxé…ç½®ï¼ˆè‡ªæ‰˜ç®¡ï¼‰**
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        root /var/www/html/frontend/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### åç«¯éƒ¨ç½²

**1. PM2éƒ¨ç½²ï¼ˆæ¨èï¼‰**
```bash
# å®‰è£…PM2
npm install -g pm2

# åˆ›å»ºPM2é…ç½®æ–‡ä»¶
# ecosystem.config.js
module.exports = {
  apps: [{
    name: 'inventory-backend',
    script: './backend/server.js',
    instances: 'max',
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_file: './logs/combined.log'
  }]
};

# å¯åŠ¨åº”ç”¨
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

**2. Dockeréƒ¨ç½²**
```dockerfile
# Dockerfile
FROM node:16-alpine

WORKDIR /app

# å¤åˆ¶package.json
COPY backend/package*.json ./
RUN npm ci --only=production

# å¤åˆ¶æºä»£ç 
COPY backend/ .

EXPOSE 3000

CMD ["node", "server.js"]
```

```bash
# æ„å»ºå’Œè¿è¡Œ
docker build -t inventory-backend .
docker run -d -p 3000:3000 --env-file .env inventory-backend
```

**3. äº‘æœåŠ¡éƒ¨ç½²**

**Railwayéƒ¨ç½²**:
```bash
# å®‰è£…Railway CLI
npm install -g @railway/cli

# ç™»å½•å’Œéƒ¨ç½²
railway login
railway init
railway up
```

**Renderéƒ¨ç½²**:
- è¿æ¥GitHubä»“åº“
- è®¾ç½®æ„å»ºå‘½ä»¤: `cd backend && npm install`
- è®¾ç½®å¯åŠ¨å‘½ä»¤: `cd backend && npm start`
- é…ç½®ç¯å¢ƒå˜é‡

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### åº”ç”¨ç›‘æ§

**1. PM2ç›‘æ§**
```bash
# æŸ¥çœ‹åº”ç”¨çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs

# ç›‘æ§é¢æ¿
pm2 monit

# é‡å¯åº”ç”¨
pm2 restart all
```

**2. å¥åº·æ£€æŸ¥**
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
curl http://localhost:3000/health

# æ£€æŸ¥å‰ç«¯æœåŠ¡
curl http://localhost:5174
```

### æ—¥å¿—ç®¡ç†

**1. æ—¥å¿—é…ç½®**
```javascript
// backend/utils/logger.js
const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.File({ filename: 'logs/error.log', level: 'error' }),
    new winston.transports.File({ filename: 'logs/combined.log' })
  ]
});

if (process.env.NODE_ENV !== 'production') {
  logger.add(new winston.transports.Console({
    format: winston.format.simple()
  }));
}

module.exports = logger;
```

**2. æ—¥å¿—è½®è½¬**
```bash
# å®‰è£…logrotate
sudo apt-get install logrotate

# é…ç½®æ–‡ä»¶ /etc/logrotate.d/inventory-app
/var/www/inventory/logs/*.log {
    daily
    missingok
    rotate 52
    compress
    delaycompress
    notifempty
    create 644 www-data www-data
    postrotate
        pm2 reloadLogs
    endscript
}
```

## ğŸ”’ å®‰å…¨é…ç½®

### HTTPSé…ç½®

**1. Let's Encryptè¯ä¹¦**
```bash
# å®‰è£…Certbot
sudo apt-get install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo crontab -e
0 12 * * * /usr/bin/certbot renew --quiet
```

**2. å®‰å…¨å¤´é…ç½®**
```javascript
// backend/middleware/security.js
const helmet = require('helmet');

app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      styleSrc: ["'self'", "'unsafe-inline'"],
      scriptSrc: ["'self'"],
      imgSrc: ["'self'", "data:", "https:"]
    }
  },
  hsts: {
    maxAge: 31536000,
    includeSubDomains: true,
    preload: true
  }
}));
```

### æ•°æ®åº“å®‰å…¨

**1. è¿æ¥å®‰å…¨**
```javascript
// ä½¿ç”¨è¿æ¥æ± 
const { Pool } = require('pg');
const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false,
  max: 20,
  idleTimeoutMillis: 30000,
  connectionTimeoutMillis: 2000,
});
```

**2. å‚æ•°åŒ–æŸ¥è¯¢**
```javascript
// é˜²æ­¢SQLæ³¨å…¥
const getProducts = async (category) => {
  const query = 'SELECT * FROM products WHERE category = $1';
  const result = await pool.query(query, [category]);
  return result.rows;
};
```

## ğŸ”§ ç»´æŠ¤æ“ä½œ

### å®šæœŸç»´æŠ¤

**1. æ•°æ®åº“ç»´æŠ¤**
```sql
-- æ¸…ç†è¿‡æœŸæ•°æ®
DELETE FROM outbound_records WHERE created_at < NOW() - INTERVAL '1 year';

-- æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
ANALYZE;

-- é‡å»ºç´¢å¼•
REINDEX DATABASE your_database;
```

**2. æ—¥å¿—æ¸…ç†**
```bash
#!/bin/bash
# cleanup.sh
find /var/www/inventory/logs -name "*.log" -mtime +30 -delete
pm2 flush
```

**3. å¤‡ä»½è„šæœ¬**
```bash
#!/bin/bash
# backup.sh
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backups"

# æ•°æ®åº“å¤‡ä»½
pg_dump $DATABASE_URL > $BACKUP_DIR/db_backup_$DATE.sql

# åº”ç”¨å¤‡ä»½
tar -czf $BACKUP_DIR/app_backup_$DATE.tar.gz /var/www/inventory

# æ¸…ç†æ—§å¤‡ä»½
find $BACKUP_DIR -name "*.sql" -mtime +7 -delete
find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete
```

### æ•…éšœæ’é™¤

**1. å¸¸è§é—®é¢˜**

**æœåŠ¡æ— æ³•å¯åŠ¨**:
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3000

# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
ps aux | grep node

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
pm2 logs --err
```

**æ•°æ®åº“è¿æ¥å¤±è´¥**:
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
psql $DATABASE_URL

# æ£€æŸ¥ç½‘ç»œè¿æ¥
ping your-supabase-host.com

# éªŒè¯ç¯å¢ƒå˜é‡
echo $SUPABASE_URL
```

**å‰ç«¯é¡µé¢æ— æ³•åŠ è½½**:
```bash
# æ£€æŸ¥æ„å»ºæ–‡ä»¶
ls -la frontend/dist/

# æ£€æŸ¥Nginxé…ç½®
nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

**2. æ€§èƒ½ä¼˜åŒ–**

**æ•°æ®åº“ä¼˜åŒ–**:
```sql
-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SELECT query, mean_time, calls 
FROM pg_stat_statements 
ORDER BY mean_time DESC 
LIMIT 10;

-- æ·»åŠ ç´¢å¼•
CREATE INDEX CONCURRENTLY idx_products_category_stock 
ON products(category, currentStock);
```

**åº”ç”¨ä¼˜åŒ–**:
```javascript
// å¯ç”¨å‹ç¼©
const compression = require('compression');
app.use(compression());

// ç¼“å­˜é™æ€èµ„æº
app.use(express.static('public', {
  maxAge: '1d',
  etag: true
}));
```

## ğŸ“ˆ æ‰©å±•éƒ¨ç½²

### è´Ÿè½½å‡è¡¡

**1. Nginxè´Ÿè½½å‡è¡¡**
```nginx
upstream backend {
    server 127.0.0.1:3000;
    server 127.0.0.1:3001;
    server 127.0.0.1:3002;
}

server {
    location /api {
        proxy_pass http://backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

**2. å¤šå®ä¾‹éƒ¨ç½²**
```javascript
// ecosystem.config.js
module.exports = {
  apps: [{
    name: 'inventory-backend',
    script: './backend/server.js',
    instances: 4,
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production'
    }
  }]
};
```

### å®¹å™¨åŒ–éƒ¨ç½²

**1. Docker Compose**
```yaml
# docker-compose.yml
version: '3.8'
services:
  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend
  
  backend:
    build: ./backend
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=${DATABASE_URL}
    volumes:
      - ./logs:/app/logs
  
  redis:
    image: redis:alpine
    ports:
      - "6379:6379"
```

**2. Kuberneteséƒ¨ç½²**
```yaml
# k8s-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: inventory-backend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: inventory-backend
  template:
    metadata:
      labels:
        app: inventory-backend
    spec:
      containers:
      - name: backend
        image: inventory-backend:latest
        ports:
        - containerPort: 3000
        env:
        - name: NODE_ENV
          value: "production"
```

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] ç¯å¢ƒå˜é‡é…ç½®å®Œæˆ
- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡
- [ ] ä¾èµ–åŒ…å®‰è£…å®Œæˆ
- [ ] æ„å»ºè¿‡ç¨‹æ— é”™è¯¯
- [ ] å®‰å…¨é…ç½®å·²åº”ç”¨

### éƒ¨ç½²åéªŒè¯
- [ ] æœåŠ¡å¯åŠ¨æ­£å¸¸
- [ ] APIæ¥å£å“åº”æ­£å¸¸
- [ ] å‰ç«¯é¡µé¢åŠ è½½æ­£å¸¸
- [ ] æ•°æ®åº“æ“ä½œæ­£å¸¸
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸

### ç›‘æ§è®¾ç½®
- [ ] å¥åº·æ£€æŸ¥é…ç½®
- [ ] é”™è¯¯ç›‘æ§è®¾ç½®
- [ ] æ€§èƒ½ç›‘æ§å¯ç”¨
- [ ] å¤‡ä»½è®¡åˆ’æ‰§è¡Œ
- [ ] å‘Šè­¦é€šçŸ¥é…ç½®

---

**ç»´æŠ¤è¯´æ˜**: æœ¬æ–‡æ¡£åŸºäºå®é™…é¡¹ç›®ç»“æ„ç¼–å†™ï¼Œæ¶µç›–äº†ä»å¼€å‘åˆ°ç”Ÿäº§çš„å®Œæ•´éƒ¨ç½²æµç¨‹ã€‚è¯·æ ¹æ®å®é™…ç¯å¢ƒè°ƒæ•´é…ç½®å‚æ•°ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œã€‚